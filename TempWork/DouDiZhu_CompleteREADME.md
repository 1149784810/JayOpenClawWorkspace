# ğŸ® æ¬¢ä¹æ–—åœ°ä¸» - Unity å®Œæ•´é¡¹ç›®

## ğŸ“¦ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„å•æœºæ–—åœ°ä¸»æ¸¸æˆï¼Œä½¿ç”¨ Unity 6000+ å¼€å‘ï¼Œæ”¯æŒç©å®¶ vs ä¸¤ä¸ªAIå¯¹æˆ˜ã€‚

**é¡¹ç›®è·¯å¾„**: `E:\XiuXianCards\XiuXianCards\Assets\TestAI\`

**å‘½åç©ºé—´**: `DDZ`

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
Assets/TestAI/
â”œâ”€â”€ Scripts/
â”‚   â”œâ”€â”€ Core/                    # æ ¸å¿ƒæ¸¸æˆé€»è¾‘
â”‚   â”‚   â”œâ”€â”€ Card.cs              # å¡ç‰Œå®šä¹‰
â”‚   â”‚   â”œâ”€â”€ CardDeck.cs          # ç‰Œå †ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ CardHand.cs          # æ‰‹ç‰Œç®¡ç†
â”‚   â”‚   â”œâ”€â”€ GameManager.cs       # æ¸¸æˆä¸»æ§åˆ¶
â”‚   â”‚   â”œâ”€â”€ GameRules.cs         # æ¸¸æˆè§„åˆ™
â”‚   â”‚   â””â”€â”€ GameTester.cs        # æµ‹è¯•å·¥å…·
â”‚   â”œâ”€â”€ Player/
â”‚   â”‚   â””â”€â”€ Player.cs            # ç©å®¶åŸºç±»
â”‚   â”œâ”€â”€ AI/
â”‚   â”‚   â””â”€â”€ AIPlayer.cs          # AIç©å®¶
â”‚   â””â”€â”€ UI/
â”‚       â”œâ”€â”€ CardUI.cs            # å¡ç‰ŒUI
â”‚       â”œâ”€â”€ GameTable.cs         # æ¸¸æˆæ¡Œé¢
â”‚       â”œâ”€â”€ UIManager.cs         # UIç®¡ç†
â”‚       â”œâ”€â”€ CardSpriteManager.cs # å›¾ç‰‡ç®¡ç†
â”‚       â”œâ”€â”€ CardFactory.cs       # å¡ç‰Œå·¥å‚
â”‚       â””â”€â”€ SceneAutoSetup.cs    # åœºæ™¯è‡ªåŠ¨é…ç½®
â”œâ”€â”€ Sprites/
â”‚   â”œâ”€â”€ Cards/                   # å¡ç‰Œå›¾ç‰‡
â”‚   â””â”€â”€ UI/                      # UIå›¾ç‰‡
â”œâ”€â”€ Prefabs/                     # é¢„åˆ¶ä½“
â”œâ”€â”€ Audio/                       # éŸ³é¢‘
â”œâ”€â”€ Resources/                   # èµ„æº
â””â”€â”€ DouDiZhuGame.unity          # ä¸»åœºæ™¯
```

---

## ğŸ® æ¸¸æˆè§„åˆ™

### ç‰ŒåŠ›å€¼
```
3 < 4 < 5 < 6 < 7 < 8 < 9 < 10 < J < Q < K < A < 2 < å°ç‹ < å¤§ç‹
1   2   3   4   5   6   7   8    9   10  11  12  13   14     15
```

### æ”¯æŒçš„ç‰Œå‹ (13ç§)
| ç‰Œå‹ | ç¤ºä¾‹ | è¯´æ˜ |
|------|------|------|
| å•å¼  | â™ 3 | ä»»æ„ä¸€å¼ ç‰Œ |
| å¯¹å­ | â™ 5+â™¥5 | 2å¼ ç›¸åŒç‚¹æ•° |
| ä¸‰å¼  | â™ 7+â™¥7+â™£7 | 3å¼ ç›¸åŒç‚¹æ•° |
| ä¸‰å¸¦ä¸€ | ä¸‰å¼ +å•å¼  | å¦‚ 777+3 |
| ä¸‰å¸¦äºŒ | ä¸‰å¼ +å¯¹å­ | å¦‚ 777+55 |
| é¡ºå­ | 3-4-5-6-7 | 5+è¿ç»­å•å¼ ï¼Œä¸å«2å’Œç‹ |
| è¿å¯¹ | 33-44-55 | 3+è¿ç»­å¯¹å­ï¼Œä¸å«2å’Œç‹ |
| é£æœº | 777-888 | 2+è¿ç»­ä¸‰å¼  |
| ç‚¸å¼¹ | KKKK | 4å¼ ç›¸åŒç‚¹æ•° |
| ç‹ç‚¸ | å°ç‹+å¤§ç‹ | æœ€å¤§ç‰Œå‹ |

### æ¸¸æˆæµç¨‹
1. **å‘ç‰Œ** - æ¯äºº17å¼ ï¼Œç•™3å¼ åº•ç‰Œ
2. **å«åœ°ä¸»** - è½®æµé€‰æ‹©æ˜¯å¦å«åœ°ä¸»
3. **ç¡®å®šåœ°ä¸»** - å«åœ°ä¸»çš„ç©å®¶è·å¾—åº•ç‰Œ
4. **å‡ºç‰Œ** - åœ°ä¸»å…ˆå‡ºï¼Œè½®æµå‡ºç‰Œ
5. **èƒœè´Ÿ** - å…ˆå‡ºå®Œç‰Œçš„ä¸€æ–¹è·èƒœ

---

## ğŸš€ å¦‚ä½•è¿è¡Œ

### æ–¹æ³•ä¸€ï¼šè‡ªåŠ¨é…ç½®ï¼ˆæ¨èï¼‰

1. æ‰“å¼€åœºæ™¯ `Assets/TestAI/DouDiZhuGame.unity`
2. ç‚¹å‡» Play æŒ‰é’®
3. **SceneAutoSetup** è„šæœ¬ä¼šè‡ªåŠ¨é…ç½®ï¼š
   - åˆ›å»º GameController
   - åˆ›å»ºä¸‰ä¸ªç©å®¶
   - è®¾ç½®ç›¸æœº
   - åˆ›å»ºèƒŒæ™¯
   - åˆ›å»ºUI
4. ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"æŒ‰é’®

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨é…ç½®

å‚è€ƒ `DouDiZhu_SceneSetup.md` è¿›è¡Œè¯¦ç»†è®¾ç½®ã€‚

---

## ğŸ¯ æ“ä½œè¯´æ˜

| æ“ä½œ | è¯´æ˜ |
|------|------|
| ç‚¹å‡»å¡ç‰Œ | é€‰æ‹©/å–æ¶ˆé€‰æ‹© |
| å‡ºç‰ŒæŒ‰é’® | å‡ºé€‰ä¸­çš„å¡ç‰Œ |
| ä¸å‡ºæŒ‰é’® | è·³è¿‡æœ¬è½® |
| æç¤ºæŒ‰é’® | æç¤ºå¯å‡ºçš„ç‰Œ |
| ç©ºæ ¼é”® | å¼€å§‹æ¸¸æˆ |
| Té”® | è¿è¡Œæµ‹è¯• |
| Dé”® | è°ƒè¯•ä¿¡æ¯ |

---

## ğŸ’» ä»£ç ç»“æ„

### Card.cs
```csharp
namespace DDZ
{
    public class Card
    {
        public CardSuit Suit;    // èŠ±è‰²
        public CardRank Rank;    // ç‚¹æ•°
        public int Value;        // ç‰ŒåŠ›å€¼ 1-15
        
        public Card(CardSuit suit, CardRank rank)
        {
            Suit = suit;
            Rank = rank;
            Value = CalculateValue();
        }
    }
}
```

### GameManager.cs
```csharp
public enum GameState 
{ 
    Idle,              // ç©ºé—²
    Dealing,           // å‘ç‰Œä¸­
    CallingLandlord,   // å«åœ°ä¸»
    Playing,           // å‡ºç‰Œä¸­
    GameOver           // æ¸¸æˆç»“æŸ
}

public class GameManager : MonoBehaviour
{
    public static GameManager Instance { get; private set; }
    public GameState CurrentState;
    public Player[] Players = new Player[3];
    
    public void StartGame() { ... }
    public void PlayCards(int playerIndex, List<Card> cards) { ... }
    public void Pass(int playerIndex) { ... }
}
```

### GameRules.cs
```csharp
public static bool IsValidPlay(List<Card> cards, List<Card> lastPlayed)
{
    var currentInfo = AnalyzeCards(cards);
    var lastInfo = AnalyzeCards(lastPlayed);
    
    // ç‹ç‚¸æœ€å¤§
    if (currentInfo.Type == CardType.JokerBomb) return true;
    
    // ç‚¸å¼¹å¯ä»¥æ‰“éç‚¸å¼¹
    if (currentInfo.Type == CardType.Bomb && lastInfo.Type != CardType.Bomb)
        return true;
    
    // åŒç±»å‹æ¯”å¤§å°
    return currentInfo.MainValue > lastInfo.MainValue;
}
```

---

## ğŸ§ª æµ‹è¯•åŠŸèƒ½

**GameTester.cs** æä¾›è‡ªåŠ¨æµ‹è¯•ï¼š
- ç‰Œå †åˆå§‹åŒ–æµ‹è¯•
- æ´—ç‰Œéšæœºæ€§æµ‹è¯•
- å‘ç‰Œæµ‹è¯•ï¼ˆ17+17+17+3ï¼‰
- ç‰Œå‹è¯†åˆ«æµ‹è¯•
- å¤§å°æ¯”è¾ƒæµ‹è¯•

æŒ‰ **T** é”®è¿è¡Œæµ‹è¯•ï¼ŒæŒ‰ **D** é”®æ‰“å°è°ƒè¯•ä¿¡æ¯ã€‚

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| `DouDiZhu_README.md` | é¡¹ç›®è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰ |
| `DouDiZhu_DevGuide.md` | å¼€å‘æŒ‡å— |
| `DouDiZhu_SceneSetup.md` | åœºæ™¯è®¾ç½®æ­¥éª¤ |

---

## âœ… åŠŸèƒ½æ¸…å•

### æ ¸å¿ƒåŠŸèƒ½
- [x] å®Œæ•´çš„å¡ç‰Œç³»ç»Ÿï¼ˆ54å¼ ç‰Œï¼‰
- [x] æ´—ç‰Œå’Œå‘ç‰Œ
- [x] å«åœ°ä¸»æµç¨‹
- [x] å›åˆåˆ¶å‡ºç‰Œ
- [x] 13ç§ç‰Œå‹è¯†åˆ«
- [x] å¤§å°æ¯”è¾ƒé€»è¾‘
- [x] AIè‡ªåŠ¨å‡ºç‰Œ
- [x] èƒœè´Ÿåˆ¤å®š

### UIåŠŸèƒ½
- [x] å¼€å§‹ç•Œé¢
- [x] æ¸¸æˆä¸»ç•Œé¢
- [x] å«åœ°ä¸»é¢æ¿
- [x] å‡ºç‰ŒæŒ‰é’®
- [x] ç©å®¶ä¿¡æ¯æ˜¾ç¤º
- [x] æ¸¸æˆç»“æŸç•Œé¢

### è¾…åŠ©åŠŸèƒ½
- [x] åœºæ™¯è‡ªåŠ¨é…ç½®
- [x] æµ‹è¯•å·¥å…·
- [x] è°ƒè¯•ä¿¡æ¯
- [x] ä»£ç å‘½åç©ºé—´

### å¾…å®Œå–„ï¼ˆå¯é€‰ï¼‰
- [ ] å¡ç‰Œç¾æœ¯èµ„æº
- [ ] éŸ³æ•ˆ
- [ ] åŠ¨ç”»æ•ˆæœ
- [ ] æ›´æ™ºèƒ½çš„AI
- [ ] è®¡åˆ†ç³»ç»Ÿ
- [ ] å¤šäººè”æœº

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ´—ç‰Œç®—æ³• (Fisher-Yates)
```csharp
for (int i = cards.Count - 1; i > 0; i--)
{
    int j = Random.Range(0, i + 1);
    (cards[i], cards[j]) = (cards[j], cards[i]);
}
```

### AIç­–ç•¥
1. éšæœºå«åœ°ä¸»
2. é€‰æ‹©æœ€å°å¯ç®¡ä¸Šçš„ç‰Œ
3. ä¼˜å…ˆå‡ºå•å¼ å’Œå¯¹å­
4. ä¿ç•™ç‚¸å¼¹åˆ°å…³é”®æ—¶åˆ»

### é¡ºå­æ£€æµ‹
```csharp
private static bool IsStraight(List<Card> cards)
{
    if (cards.Any(c => c.Value >= 13)) return false; // ä¸èƒ½æœ‰2å’Œç‹
    var values = cards.Select(c => c.Value).OrderBy(v => v);
    return values.Zip(values.Skip(1), (a, b) => b - a).All(d => d == 1);
}
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q: å¡ç‰Œä¸æ˜¾ç¤ºï¼Ÿ
A: æ£€æŸ¥ Card é¢„åˆ¶ä½“æ˜¯å¦æœ‰ SpriteRendererï¼Œæˆ– CardFactory æ˜¯å¦æ­£ç¡®è®¾ç½®ã€‚

### Q: æ— æ³•ç‚¹å‡»å¡ç‰Œï¼Ÿ
A: æ£€æŸ¥ Card æ˜¯å¦æœ‰ BoxCollider2Dï¼Œç›¸æœºæ˜¯å¦ä¸º Orthographicã€‚

### Q: AIä¸å‡ºç‰Œï¼Ÿ
A: æ£€æŸ¥ AIPlayer æ˜¯å¦æ­£ç¡®æ·»åŠ åˆ° AI ç‰©ä½“ï¼ŒIsAI æ ‡å¿—æ˜¯å¦è®¾ç½®ã€‚

### Q: åœºæ™¯æ²¡æœ‰è‡ªåŠ¨é…ç½®ï¼Ÿ
A: ç¡®ä¿ GameController æœ‰ SceneAutoSetup è„šæœ¬ï¼ŒAutoSetup å‹¾é€‰ã€‚

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Unity ç‰ˆæœ¬æ˜¯å¦ä¸º 6000+
2. æ‰€æœ‰è„šæœ¬æ˜¯å¦éƒ½åœ¨ DDZ å‘½åç©ºé—´
3. åœºæ™¯æ˜¯å¦æ­£ç¡®ä¿å­˜
4. æ§åˆ¶å°æ˜¯å¦æœ‰æŠ¥é”™

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0 (2026-02-11)
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- å®Œæ•´æ–—åœ°ä¸»è§„åˆ™å®ç°
- æ”¯æŒç©å®¶ vs ä¸¤ä¸ªAI
- 13ç§ç‰Œå‹è¯†åˆ«
- åœºæ™¯è‡ªåŠ¨é…ç½®
- æµ‹è¯•å·¥å…·

---

**ç‰ˆæœ¬**: 1.0  
**ä½œè€…**: AI Assistant  
**æ—¥æœŸ**: 2026-02-11

**ç¥æ¸¸æˆæ„‰å¿«ï¼ğŸ®**
